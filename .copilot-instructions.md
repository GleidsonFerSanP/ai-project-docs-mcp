# ü§ñ Copilot Instructions - Project Docs MCP

> **IMPORTANTE**: Estas instru√ß√µes devem ser seguidas em TODAS as intera√ß√µes neste projeto.

## üìã Workflow Obrigat√≥rio

**ATEN√á√ÉO**: Este projeto possui um MCP (Model Context Protocol) server ativo chamado "project-docs".
Sempre que as a√ß√µes abaixo forem necess√°rias, use o MCP atrav√©s do bot√£o de MCPs no GitHub Copilot Chat.

### Antes de Qualquer Mudan√ßa de C√≥digo

1. **Identifique o contexto do arquivo**:

   - Use a tool MCP: `identify_context` passando o file_path
   - Isso detecta automaticamente se √© backend, frontend, ou infra

2. **Obtenha contratos cr√≠ticos**:

   - Use a tool MCP: `get_contracts` com o contexto detectado
   - SEMPRE valide implementa√ß√µes contra contratos existentes

3. **Consulte contexto completo do projeto**:
   - Use o prompt MCP: `project-context`
   - Isso retorna contratos, padr√µes, decis√µes e guidelines em um √∫nico prompt

### Antes de Criar Documenta√ß√£o

1. **SEMPRE verificar se j√° existe documenta√ß√£o similar**:

   - Use a tool MCP: `check_existing_documentation`
   - Passe: title, topics, keywords
   - Se similaridade ‚â• 50%: ATUALIZAR documento existente, N√ÉO criar novo

2. **Registrar metadata ap√≥s criar/atualizar arquivo .md**:
   - Use a tool MCP: `manage_documentation`
   - action: "create" (novo) ou "update" (existente)
   - Inclua: title, file_path (relativo ao projeto), topics, keywords, summary

### Ao Implementar C√≥digo

1. **Validar contra contratos registrados**:

   - Use a tool MCP: `validate_contract`
   - Passa contract_name e o c√≥digo a validar
   - Garante que implementa√ß√µes seguem interfaces cr√≠ticas

2. **Aplicar padr√µes conhecidos**:
   - Use a tool MCP: `get_feature_context` para features relacionadas
   - Reutilize patterns aprendidos anteriormente

### Ao Fazer Decis√µes Arquiteturais

1. **Registrar TODAS as decis√µes importantes**:
   - Use a tool MCP: `add_decision`
   - Inclua: title, context (por qu√™?), decision (o qu√™?), alternatives, consequences
   - Decis√µes viram ADRs (Architectural Decision Records)

## üéØ Stack do Projeto

- **MCP Server**: TypeScript + @modelcontextprotocol/sdk
- **VS Code Extension**: TypeScript + VS Code API
- **Protocol**: MCP stdio transport
- **Storage**: JSON files (~/.project-docs-mcp/)

## üèóÔ∏è Princ√≠pios Arquiteturais

1. **Clean Architecture**: Separa√ß√£o clara entre dom√≠nio, aplica√ß√£o e infra
2. **Single Responsibility**: Cada m√≥dulo tem uma responsabilidade √∫nica
3. **MCP Standards**: Seguir rigorosamente o protocolo MCP
4. **Zero Config**: Funcionar out-of-the-box sem configura√ß√£o manual
5. **Cross-platform**: macOS, Linux, Windows

## üîí Contratos Cr√≠ticos

### MCP Server

- Deve usar stdio transport (n√£o HTTP)
- Tools devem retornar formato `{ content: [{ type: 'text', text: string }] }`
- Errors devem ser tratados e retornados como JSON v√°lido

### VS Code Extension

- Deve registrar via `vscode.lm.registerMcpServerDefinitionProvider`
- Deve declarar `mcpServerDefinitionProviders` no package.json
- Deve incluir node_modules do mcp-server no .vsix

## üìù Conven√ß√µes de C√≥digo

- **TypeScript strict mode** habilitado
- **Imports**: Sempre usar extens√£o `.js` para imports de arquivos locais
- **Error handling**: Sempre catch e retornar mensagens claras
- **Logging**: Usar console.error para erros, evitar console.log em produ√ß√£o
- **MCP Tools**: Retornar sempre `{ content: [{ type: 'text', text: JSON.stringify(result) }] }`

## üö´ O Que NUNCA Fazer

- ‚ùå Criar documenta√ß√£o duplicada sem usar `check_existing_documentation` primeiro
- ‚ùå Modificar contratos cr√≠ticos sem validar todas implementa√ß√µes existentes
- ‚ùå Fazer decis√µes arquiteturais sem registr√°-las via `add_decision`
- ‚ùå Quebrar compatibilidade do protocolo MCP
- ‚ùå Usar require() - sempre usar ES modules (import/export)
- ‚ùå Hardcodar paths absolutos - usar homedir() e join() para cross-platform

## üîß Quando Usar Cada Tool MCP

| Situa√ß√£o                      | Tool MCP                                                | Quando Usar                                    |
| ----------------------------- | ------------------------------------------------------- | ---------------------------------------------- |
| Mudando c√≥digo                | `identify_context`                                      | Antes de editar qualquer arquivo               |
| Implementando interface       | `get_contracts` + `validate_contract`                   | Ao criar classes que implementam contratos     |
| Criando docs                  | `check_existing_documentation` ‚Üí `manage_documentation` | Antes e depois de criar .md                    |
| Aprendendo padr√£o novo        | `learn_pattern`                                         | Quando identificar padr√£o recorrente no c√≥digo |
| Registrando interface cr√≠tica | `register_contract`                                     | Interfaces que DEVEM ser seguidas              |
| Decis√£o arquitetural          | `add_decision`                                          | Qualquer escolha t√©cnica importante            |
| Nova feature completa         | `register_feature`                                      | Feature com regras de neg√≥cio e casos de uso   |
| Consultar tudo de uma vez     | Prompt: `project-context`                               | In√≠cio de sess√£o ou contexto completo          |

## üéØ Como Funciona o MCP Neste Projeto

1. **Servidor MCP** roda via stdio quando VS Code inicia
2. **GitHub Copilot** acessa via bot√£o MCP na interface do chat
3. **Dados persistem** em `~/.project-docs-mcp/knowledge/ai-project-docs-mcp/`
4. **Arquivos JSON**: contracts.json, patterns.json, decisions.json, features.json

## üìö Recursos √öteis

- MCP Docs: https://modelcontextprotocol.io
- VS Code API: https://code.visualstudio.com/api
- Este projeto no GitHub: https://github.com/GleidsonFerSanP/ai-project-docs-mcp

---

**Lembre-se**: Este projeto DEVE usar seu pr√≥prio MCP para auto-documenta√ß√£o. Pratique o que prega! üéØ
